# 阶段 2: 6-nodes 网络验证

**状态**: ⏸️ 待开始  
**依赖**: 阶段 1（节点异质性实现）必须完成  
**预估时间**: 2小时

---

## 🎯 目标

在小规模网络（6个节点）上验证：
1. ✅ 全局耦合功能正常
2. ✅ 延迟效应存在
3. ✅ 节点异质性有效
4. ✅ 功能连接合理（Mean |FC| = 0.3-0.7）

---

## 📋 测试清单

### **测试 2.1: 基础耦合** (`test_01_basic_coupling.py`)

**目的**: 验证全局耦合参数 `K_gl` 有效

**网络配置**:
- 2 个节点
- 强连接（Cmat[0,1] = Cmat[1,0] = 1.0）

**测试内容**:
1. K_gl = 0.0（无耦合） → 两节点完全独立
2. K_gl = 0.5（有耦合） → 两节点有相关性

**验证标准**:
- K_gl = 0.0 时，FC < 0.1
- K_gl = 0.5 时，FC > 0.3

**输出**:
- `results/six_nodes/01_basic_coupling_2025-10-XX.png`

---

### **测试 2.2: 延迟效应** (`test_02_delay_effect.py`)

**目的**: 验证距离矩阵 `Dmat` 影响延迟

**网络配置**:
- 2 个节点
- 测试不同距离: Dmat = 0mm, 50mm, 100mm

**测试内容**:
- 观察相位差随距离增加

**验证标准**:
- 距离越大，相位差越明显
- 互相关峰值位置随距离移动

**输出**:
- `results/six_nodes/02_delay_effect_2025-10-XX.png`

---

### **测试 2.3: 异质性参数** (`test_03_heterogeneity.py`)

**目的**: 验证节点异质性降低同步性

**网络配置**:
- 6 个节点
- 全连接（Cmat = ones - eye）
- 每个节点不同 B 参数

**测试内容**:
1. 无异质性: 所有节点 B = 30
2. 有异质性: B = [50, 40, 30, 20, 25, 35]

**验证标准**:
- 无异质性: Mean |FC| > 0.9
- 有异质性: Mean |FC| < 0.8
- 峰值频率 std > 1 Hz

**输出**:
- `results/six_nodes/03_heterogeneity_2025-10-XX.png`

---

### **测试 2.4: 完整分析** (`test_04_complete_analysis.py`)

**目的**: 综合分析 6 节点网络

**网络配置**:
- 6 个节点
- 明确的连接结构（不是全连接）
- 异质性参数

**分析内容**:
1. Activity 时间序列
2. PSD 频谱分析
3. FC 矩阵
4. SC vs FC 对比
5. 节点统计

**验证标准**:
- Mean |FC| 在 0.3-0.7 范围
- 有 SC 的节点对 FC 较高
- 无 SC 的节点对 FC 较低

**输出**:
- `results/six_nodes/04_complete_analysis_2025-10-XX.png`
- 4x3 网格图片

---

## 📊 成功标准总结

### **定量指标**

| 指标 | 合格标准 | 优秀标准 |
|------|---------|---------|
| Mean \|FC\| | 0.3 - 0.8 | 0.4 - 0.6 |
| FC 标准差 | > 0.1 | > 0.15 |
| 峰值频率 std | > 1 Hz | > 2 Hz |
| SC-FC 相关性 | > 0.2 | > 0.4 |

### **定性检查**

- [ ] 节点活动视觉上明显不同
- [ ] PSD 峰值频率有分布
- [ ] FC 矩阵不是全红（0.99）
- [ ] SC 和 FC 有相似的模式

---

## 🚨 常见问题

### **Q1: FC 仍然很高（> 0.9）怎么办？**

**可能原因**:
1. 参数没有向量化（仍然是标量）
2. heterogeneity 参数太小

**解决方法**:
```python
# 检查参数类型
print(type(model.params['B']))  # 应该是 numpy.ndarray
print(model.params['B'])        # 应该看到不同的值

# 增加异质性
model = WendlingModel(Cmat=Cmat, heterogeneity=0.2)  # 从 0.1 增加到 0.2
```

---

### **Q2: 节点活动完全相同怎么办？**

**检查清单**:
- [ ] 参数是否为向量？
- [ ] 初始条件是否有差异？
- [ ] random_init 是否为 True？

---

### **Q3: 模拟发散（振幅爆炸）怎么办？**

**可能原因**:
1. dt 太大
2. K_gl 太大
3. 参数超出合理范围

**解决方法**:
```python
model.params['dt'] = 0.1      # 确保 dt = 0.1 ms
model.params['K_gl'] = 0.3    # 降低全局耦合
```

---

## 📝 文件清单

创建以下档案：

- [ ] `test_01_basic_coupling.py`
- [ ] `test_02_delay_effect.py`
- [ ] `test_03_heterogeneity.py`
- [ ] `test_04_complete_analysis.py`

所有测试脚本应该：
1. 有清晰的注释
2. 打印进度信息
3. 保存结果图片
4. 验证结果是否符合标准

---

## 🔗 参考

- 完整计划: [../../PLAN.md](../../PLAN.md)
- 技术分析: [../../docs/01_ANALYSIS_ALN_vs_WENDLING.md](../../docs/01_ANALYSIS_ALN_vs_WENDLING.md)

---

**创建日期**: 2025-10-13  
**最后更新**: 2025-10-13
